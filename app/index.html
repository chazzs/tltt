<!doctype html>
<html lang="en" style="height: 100%;">
    <head>
        <!-- Philomela -->
        <meta charset="UTF-8" />
        <title>2 Loud 2 Talk</title>
        <style type="text/css">
            body{
                font-family: monospace;
                font-size: 24px;
                color: #34515e;
                height: 100%;
                margin:0;
                text-align: center;
                overflow: hidden;
            }
            svg{
                fill:#34515e;
            }
            textarea {
                width: 100%;
                height: 100%;
                padding-top: 2rem;
                line-height: 1.5;
                font-size: 4rem;
                letter-spacing: 1px;
                border: none;
                background-color: whitesmoke;
                touch-action: manipulation;
            }
            textarea::placeholder{
                text-align: center;
            }
            .bar{
                display: flex;
                justify-content: center;
                padding:4rem 0;
                line-height: 4rem;
                touch-action: manipulation;
            }
            .bar h1{
                margin: 0 3rem;
            }
            .button{
                cursor: pointer;
                font-size: 4rem;
                margin:0 1rem;
            }
            .disable{
                color: #ccc;
                cursor: not-allowed;
            }
            .disable svg{
                fill:#ccc;
            }

            .canvas{
                display: flex;
                height: 100%;
            }

            body.dark .button.disable svg{
                fill: #424242;
            }
            body.dark .bar,
            body.dark textarea,
            body.dark section,
            body.dark svg{
                background-color: #231f20;
                color: #c1c1c1;
                fill: #c1c1c1;
            }

            section.info,
            section.history{
                position: fixed;
                display: none;
                padding:2rem;
                font-size: 32px;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: whitesmoke;
                z-index: 2;
                cursor: pointer;
            }
        </style>
        <script type="text/javascript">
        </script>
    </head>
    <body>
        <section class="bar">
            <span class="button left disable" onclick="if(!this.classList.contains('disable')){showText(--s)}">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512"><path d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"/></svg>
            </span>
            <span class="button help" onclick="if(!this.classList.contains('disable')){showHelp(true)}">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512"><path d="M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"/></svg>
            </span>
            <span class="button hist disable" onclick="if(!this.classList.contains('disable')){showHistory(true)}">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path d="M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"/></svg>
            </span>
            <h1>2 Loud 2 Talk</h1>
            <span class="button remove" onclick="if(!this.classList.contains('disable')){clearArea()}">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"/></svg>
            </span>
            <span class="button dark">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/></svg>
            </span>
            <span class="button right disable" onclick="if(!this.classList.contains('disable')){showText(++s)}">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
            </span>
        </section>
        <section class="canvas">
            <textarea placeholder="&lt;double tap to clear&gt;"></textarea>
        </section>
        <section class="info" onclick="showHelp(false)">
            <div>
                <h3>Too Loud To Talk (tltt)</h3>
                <p>A simple hyper-local chat app.</p>
                <p>
                    For those times when you just can't hear the person you are talking to or,
                    for the times when "quiet" is the name of the game. You can pass along a simple
                    message and don't have hassle with SMS or other messaging services or noisy
                    notifications or buzzing.
                </p>
                    <h4>Buttons across the top do stuff</h4>
                    <ul style="text-align: initial;">
                        <li>Dark mode</li>
                        <li>Clear the window(or double tap  the text)</li>
                        <li>Go back and forward though text history</li>
                        <li>See this fancy help</li>
                    </ul>
                <p style="text-align: initial;">
                    Type up a message and show it to someone!<br>
                    Pass back and forth to read and/or respond.
                </p>
                <p style="margin-top:8rem; font-style:italic;">
                    &lt; tap to close &gt;
                </p>
            </div>
        </section>
        <section class="history" onclick="showHistory(false)">
            <ul></ul>
        </section>
        <script type="text/javascript">
            upm = new URLSearchParams(window.location.search);
            if(upm.has('dark'))
                document.body.classList.add("dark");

            s = 0;
            const stack = [];
            const area  = document.querySelector("textarea");
            const left  = document.querySelector(".button.left")
            const right = document.querySelector(".button.right")
            const dark  = document.querySelector(".button.dark")
            const hist  = document.querySelector(".button.hist")
            const help  = document.querySelector(".button.help")
            const rem   = document.querySelector(".button.remove")

            dark.addEventListener('click', (e) => {
                if( document.body.classList.contains("dark")){
                    window.location.search = "";
                }
                else{
                    window.location.search = "?dark";
                }
            });

            area.addEventListener('keydown', (e) => {
                area.dataset['mod'] = 1;
            });
            area.addEventListener("dblclick", (e) => {
                e.preventDefault();
                e.stopImmediatePropagation();
                e.stopPropagation();
                clearArea();
            });

            function showText(idx){
                area.value = stack[idx];
                if(idx > 0 && idx < stack.length-1){
                    left.classList.remove("disable");
                    right.classList.remove("disable");
                }
                else if(idx <= 0){
                    left.classList.add("disable");
                    right.classList.remove("disable");
                }
                else if(idx >= stack.length-1){
                    right.classList.add("disable");
                    left.classList.remove("disable");
                }
            }
            function clearArea(){
                if( (area.dataset['mod'] == 1) && (area.value.trim().length > 0) ){
                    stack.push(area.value);
                    right.classList.add("disable");
                    left.classList.remove("disable");
                    hist.classList.remove("disable");
                }
                s = stack.length;
                area.value="";
                area.dataset['mod'] = 0;
            }
            function showHelp(t){
                let hlp = document.querySelector("section.info");
                if(t)
                   hlp.style.display = "block";
                else
                    hlp.style.removeProperty("display");
            }

            function showHistory(t){
                let hst = document.querySelector("section.history");
                let lst = document.querySelector("section.history ul");
                let itm = document.querySelector("section.history ul li");
                if(itm == null){
                    //generate li list.
                    stack.forEach(element => {
                        let el = document.createElement('li');
                        el.append(element);
                        lst.append(el);
                    });
                }
                if(t)
                   hst.style.display = "block";
                else
                    hst.style.removeProperty("display");
            }
        </script>
    </body>
</html>